<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Welcome, Julia! | Listening To Life</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Welcome, Julia!" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Logistic regression from scratch in Julia" />
<meta property="og:description" content="Logistic regression from scratch in Julia" />
<link rel="canonical" href="abhishekswain.me/machine%20learning/maths/2020/07/28/Logistic_regression.html" />
<meta property="og:url" content="abhishekswain.me/machine%20learning/maths/2020/07/28/Logistic_regression.html" />
<meta property="og:site_name" content="Listening To Life" />
<meta property="og:image" content="abhishekswain.me/images/download.jiff" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-28T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Logistic regression from scratch in Julia","mainEntityOfPage":{"@type":"WebPage","@id":"abhishekswain.me/machine%20learning/maths/2020/07/28/Logistic_regression.html"},"@type":"BlogPosting","url":"abhishekswain.me/machine%20learning/maths/2020/07/28/Logistic_regression.html","headline":"Welcome, Julia!","dateModified":"2020-07-28T00:00:00-05:00","datePublished":"2020-07-28T00:00:00-05:00","image":"abhishekswain.me/images/download.jiff","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="abhishekswain.me/feed.xml" title="Listening To Life" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.png"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Welcome, Julia! | Listening To Life</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Welcome, Julia!" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Logistic regression from scratch in Julia" />
<meta property="og:description" content="Logistic regression from scratch in Julia" />
<link rel="canonical" href="abhishekswain.me/machine%20learning/maths/2020/07/28/Logistic_regression.html" />
<meta property="og:url" content="abhishekswain.me/machine%20learning/maths/2020/07/28/Logistic_regression.html" />
<meta property="og:site_name" content="Listening To Life" />
<meta property="og:image" content="abhishekswain.me/images/download.jiff" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-07-28T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"Logistic regression from scratch in Julia","mainEntityOfPage":{"@type":"WebPage","@id":"abhishekswain.me/machine%20learning/maths/2020/07/28/Logistic_regression.html"},"@type":"BlogPosting","url":"abhishekswain.me/machine%20learning/maths/2020/07/28/Logistic_regression.html","headline":"Welcome, Julia!","dateModified":"2020-07-28T00:00:00-05:00","datePublished":"2020-07-28T00:00:00-05:00","image":"abhishekswain.me/images/download.jiff","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="abhishekswain.me/feed.xml" title="Listening To Life" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Listening To Life</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/aboutme/">About Me</a><a class="page-link" href="/projects/">Projects</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Welcome, Julia!</h1><p class="page-description">Logistic regression from scratch in Julia</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-07-28T00:00:00-05:00" itemprop="datePublished">
        Jul 28, 2020
      </time>
       ‚Ä¢ <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/categories/#machine learning">machine learning</a>
        &nbsp;
      
        <a class="category-tags-link" href="/categories/#maths">maths</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#splitting-into-train--test-set">Splitting into train &amp; test set</a></li>
<li class="toc-entry toc-h2"><a href="#mathematical-expression-of-the-algorithm">Mathematical expression of the algorithm:</a></li>
<li class="toc-entry toc-h2"><a href="#sigmoid">Sigmoid</a></li>
<li class="toc-entry toc-h2"><a href="#random-initialization">Random initialization</a></li>
<li class="toc-entry toc-h2"><a href="#notation">Notation</a></li>
<li class="toc-entry toc-h2"><a href="#forward-and-backward-propagation">Forward and Backward propagation</a></li>
<li class="toc-entry toc-h2"><a href="#model">Model</a></li>
<li class="toc-entry toc-h2"><a href="#plotting">Plotting</a></li>
</ul><div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">DelimitedFiles</span>
<span class="k">using</span> <span class="n">Random</span>
<span class="k">using</span> <span class="n">Plots</span>
</code></pre></div></div>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">file</span> <span class="o">=</span> <span class="n">DelimitedFiles</span><span class="o">.</span><span class="n">readdlm</span><span class="x">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Users</span><span class="se">\\</span><span class="s">Abhishek Swain</span><span class="se">\\</span><span class="s">Desktop</span><span class="se">\\</span><span class="s">Julia_ML</span><span class="se">\\</span><span class="s">data_banknote_authentication.txt"</span><span class="x">,</span> <span class="sc">','</span><span class="x">);</span>
</code></pre></div></div>

<p>See the first 5 rows of the given array</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> head</span><span class="x">(</span><span class="n">file</span><span class="x">)</span>
    <span class="n">file</span><span class="x">[</span><span class="mi">1</span><span class="o">:</span><span class="mi">5</span><span class="x">,</span> <span class="mi">1</span><span class="o">:</span><span class="mi">5</span><span class="x">]</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>head (generic function with 1 method)
</code></pre></div></div>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">head</span><span class="x">(</span><span class="n">file</span><span class="x">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5√ó5 Array{Float64,2}:
 3.6216    8.6661  -2.8073  -0.44699  0.0
 4.5459    8.1674  -2.4586  -1.4621   0.0
 3.866    -2.6383   1.9242   0.10645  0.0
 3.4566    9.5228  -4.0112  -3.5944   0.0
 0.32924  -4.4552   4.5718  -0.9888   0.0
</code></pre></div></div>

<h2 id="splitting-into-train--test-set">
<a class="anchor" href="#splitting-into-train--test-set" aria-hidden="true"><span class="octicon octicon-link"></span></a>Splitting into train &amp; test set</h2>
<p>splits the data into train and test set</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> train_test_split</span><span class="x">(</span><span class="n">file</span><span class="x">,</span> <span class="n">at</span><span class="o">=</span><span class="mf">0.7</span><span class="x">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">size</span><span class="x">(</span><span class="n">file</span><span class="x">,</span> <span class="mi">1</span><span class="x">)</span>

    <span class="n">idx</span> <span class="o">=</span> <span class="n">shuffle</span><span class="x">(</span><span class="mi">1</span><span class="o">:</span><span class="n">n</span><span class="x">)</span>
    
    <span class="n">train_idx</span> <span class="o">=</span> <span class="n">view</span><span class="x">(</span><span class="n">idx</span><span class="x">,</span> <span class="mi">1</span><span class="o">:</span><span class="n">floor</span><span class="x">(</span><span class="kt">Int</span><span class="x">,</span> <span class="n">at</span><span class="o">*</span><span class="n">n</span><span class="x">))</span>
    <span class="n">test_idx</span> <span class="o">=</span> <span class="n">view</span><span class="x">(</span><span class="n">idx</span><span class="x">,</span> <span class="x">(</span><span class="n">floor</span><span class="x">(</span><span class="kt">Int</span><span class="x">,</span> <span class="n">at</span><span class="o">*</span><span class="n">n</span><span class="x">)</span><span class="o">+</span><span class="mi">1</span><span class="x">)</span><span class="o">:</span><span class="n">n</span><span class="x">)</span>
    
    <span class="n">file</span> <span class="o">=</span> <span class="n">convert</span><span class="x">(</span><span class="kt">Matrix</span><span class="x">,</span> <span class="n">file</span><span class="x">)</span>
    <span class="k">return</span> <span class="n">file</span><span class="x">[</span><span class="n">train_idx</span><span class="x">,</span><span class="o">:</span><span class="x">],</span> <span class="n">file</span><span class="x">[</span><span class="n">test_idx</span><span class="x">,</span><span class="o">:</span><span class="x">]</span>

<span class="k">end</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>train_test_split (generic function with 2 methods)
</code></pre></div></div>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data_train</span><span class="x">,</span> <span class="n">data_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="x">(</span><span class="n">file</span><span class="x">,</span> <span class="mf">0.25</span><span class="x">);</span>

<span class="n">X</span><span class="x">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">data_train</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="mi">1</span><span class="o">:</span><span class="mi">4</span><span class="x">],</span> <span class="n">data_train</span><span class="x">[</span><span class="o">:</span><span class="x">,</span> <span class="mi">5</span><span class="x">];</span>
</code></pre></div></div>

<h2 id="mathematical-expression-of-the-algorithm">
<a class="anchor" href="#mathematical-expression-of-the-algorithm" aria-hidden="true"><span class="octicon octicon-link"></span></a><strong>Mathematical expression of the algorithm</strong>:</h2>

<p>For one example $x^{(i)}$:
<span class="katex-error" title="ParseError: KaTeX parse error: \tag works only in display equations" style="color:#cc0000">z^{(i)} = w^T x^{(i)} + b \tag{1}</span>
<span class="katex-error" title="ParseError: KaTeX parse error: \tag works only in display equations" style="color:#cc0000">\hat{y}^{(i)} = a^{(i)} = sigmoid(z^{(i)})\tag{2}</span> 
<span class="katex-error" title="ParseError: KaTeX parse error: \tag works only in display equations" style="color:#cc0000">\mathcal{L}(a^{(i)}, y^{(i)}) =  - y^{(i)}  \log(a^{(i)}) - (1-y^{(i)} )  \log(1-a^{(i)})\tag{3}</span></p>

<p>The cost is then computed by summing over all training examples:
<span class="katex-error" title="ParseError: KaTeX parse error: \tag works only in display equations" style="color:#cc0000">J = \frac{1}{m} \sum_{i=1}^m \mathcal{L}(a^{(i)}, y^{(i)})\tag{6}</span></p>

<h2 id="sigmoid">
<a class="anchor" href="#sigmoid" aria-hidden="true"><span class="octicon octicon-link"></span></a>Sigmoid</h2>
<p>Applies sigmoid to the vector</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> </span><span class="o">œÉ(</span><span class="n">z</span><span class="x">)</span> 
    <span class="s">"""
    Compute the sigmoid of z
    """</span>
    <span class="k">return</span> <span class="n">one</span><span class="x">(</span><span class="n">z</span><span class="x">)</span> <span class="o">/</span> <span class="x">(</span><span class="n">one</span><span class="x">(</span><span class="n">z</span><span class="x">)</span> <span class="o">+</span> <span class="n">exp</span><span class="x">(</span><span class="o">-</span><span class="n">z</span><span class="x">))</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>œÉ (generic function with 1 method)
</code></pre></div></div>

<h2 id="random-initialization">
<a class="anchor" href="#random-initialization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Random initialization</h2>
<p>Initialize <code class="highlighter-rouge">w</code> &amp; <code class="highlighter-rouge">b</code> with with random values between (0, 1)</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> initialize</span><span class="x">(</span><span class="n">dim</span><span class="x">)</span>
    <span class="s">"""
    This function creates a vector of zeros of shape (dim, 1) for w and initializes b to 0.
    
    Argument:
    dim -- size of the w vector we want (or number of parameters in this case)
    
    Returns:
    w -- initialized vector of shape (dim, 1)
    b -- initialized scalar (corresponds to the bias)
    """</span>
    
    <span class="n">w</span> <span class="o">=</span> <span class="n">rand</span><span class="x">(</span><span class="kt">Float64</span><span class="x">,</span> <span class="x">(</span><span class="n">dim</span><span class="x">,</span> <span class="mi">1</span><span class="x">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="nd">@assert</span><span class="x">(</span><span class="n">size</span><span class="x">(</span><span class="n">w</span><span class="x">)</span> <span class="o">==</span> <span class="x">(</span><span class="n">dim</span><span class="x">,</span> <span class="mi">1</span><span class="x">))</span>
    <span class="nd">@assert</span><span class="x">(</span><span class="k">isa</span><span class="x">(</span><span class="n">b</span><span class="x">,</span> <span class="kt">Float64</span><span class="x">)</span> <span class="o">||</span> <span class="k">isa</span><span class="x">(</span><span class="n">b</span><span class="x">,</span> <span class="kt">Int64</span><span class="x">))</span>
    
    <span class="k">return</span> <span class="n">w</span><span class="x">,</span> <span class="n">b</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>initialize (generic function with 1 method)
</code></pre></div></div>

<h2 id="notation">
<a class="anchor" href="#notation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Notation</h2>

<ul>
  <li>According to our notation, <code class="highlighter-rouge">X</code> is of shape <em>(num_features, num_examples)</em>, in our case that is (4, 343). So, we need to reshape our <code class="highlighter-rouge">X</code>.</li>
  <li>
<code class="highlighter-rouge">m</code> is the number of tranining examples.</li>
  <li>Similarly, <code class="highlighter-rouge">y</code> is a row vector or as Julia likes to call it <code class="highlighter-rouge">Array{Float64, 2}</code> of shape <em>(1, num_examples)</em>.</li>
</ul>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">reshape</span><span class="x">(</span><span class="n">X</span><span class="x">,</span> <span class="x">(</span><span class="n">size</span><span class="x">(</span><span class="n">X</span><span class="x">,</span> <span class="mi">2</span><span class="x">),</span> <span class="n">size</span><span class="x">(</span><span class="n">X</span><span class="x">,</span> <span class="mi">1</span><span class="x">)))</span>
<span class="n">size</span><span class="x">(</span><span class="n">X</span><span class="x">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(4, 343)
</code></pre></div></div>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">m</span> <span class="o">=</span> <span class="n">size</span><span class="x">(</span><span class="n">X</span><span class="x">,</span> <span class="mi">2</span><span class="x">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>343
</code></pre></div></div>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="n">reshape</span><span class="x">(</span><span class="n">y</span><span class="x">,</span> <span class="x">(</span><span class="mi">1</span><span class="x">,</span> <span class="n">size</span><span class="x">(</span><span class="n">y</span><span class="x">,</span> <span class="mi">1</span><span class="x">)))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1√ó343 Array{Float64,2}:
 0.0  1.0  1.0  0.0  0.0  1.0  0.0  0.0  ‚Ä¶  0.0  1.0  0.0  1.0  1.0  0.0  1.0
</code></pre></div></div>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cost</span> <span class="o">=</span> <span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">}(</span><span class="nb">undef</span><span class="x">,</span> <span class="mi">343</span><span class="x">,</span> <span class="mi">1</span><span class="x">);</span>
</code></pre></div></div>

<h2 id="forward-and-backward-propagation">
<a class="anchor" href="#forward-and-backward-propagation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Forward and Backward propagation</h2>

<p><code class="highlighter-rouge">propagate</code> function is the function at the heart of the algorithm. This does the <strong>forward prop -&gt; calculate cost -&gt; back-prop</strong>.</p>

<p>Forward Propagation:</p>
<ul>
  <li>You get X</li>
  <li>You compute $A = \sigma(w^T X + b) = (a^{(1)}, a^{(2)}, ‚Ä¶, a^{(m-1)}, a^{(m)})$</li>
  <li>You calculate the cost function: $J = -\frac{1}{m}\sum_{i=1}^{m}y^{(i)}\log(a^{(i)})+(1-y^{(i)})\log(1-a^{(i)})$</li>
</ul>

<p>Here are the two formulas you will be using:</p>

<p><span class="katex-error" title="ParseError: KaTeX parse error: \tag works only in display equations" style="color:#cc0000">\frac{\partial J}{\partial w} = \frac{1}{m}X(A-Y)^T\tag{7}</span>
<span class="katex-error" title="ParseError: KaTeX parse error: \tag works only in display equations" style="color:#cc0000">\frac{\partial J}{\partial b} = \frac{1}{m} \sum_{i=1}^m (a^{(i)}-y^{(i)})\tag{8}</span></p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span><span class="nf"> propagate</span><span class="x">(</span><span class="n">w</span><span class="x">,</span> <span class="n">b</span><span class="x">,</span> <span class="n">X</span><span class="x">,</span> <span class="n">Y</span><span class="x">)</span>
    <span class="s">"""
    Implement the cost function and its gradient for the propagation explained above

    Arguments:
    w -- weights, a numpy array of size (num_px * num_px * 3, 1)
    b -- bias, a scalar
    X -- data of size (num_px * num_px * 3, number of examples)
    Y -- true "</span><span class="n">label</span><span class="s">" vector (containing 0 if non-cat, 1 if cat) of size (1, number of examples)

    Return:
    cost -- negative log-likelihood cost for logistic regression
    dw -- gradient of the loss with respect to w, thus same shape as w
    db -- gradient of the loss with respect to b, thus same shape as b
    
    Tips:
    - Write your code step by step for the propagation
    """</span>
    
    <span class="c"># Forward prop</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">w</span><span class="err">'</span><span class="n">X</span> <span class="o">.+</span> <span class="n">b</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">œÉ</span><span class="o">.</span><span class="x">(</span><span class="n">Z</span><span class="x">)</span>
    <span class="nd">@assert</span><span class="x">(</span><span class="n">size</span><span class="x">(</span><span class="n">A</span><span class="x">)</span> <span class="o">==</span> <span class="n">size</span><span class="x">(</span><span class="n">y</span><span class="x">))</span>
    
    <span class="c"># Compute cost</span>
    <span class="err">ùí•</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">sum</span><span class="x">(</span><span class="n">y</span> <span class="o">.*</span> <span class="n">log</span><span class="o">.</span><span class="x">(</span><span class="n">A</span><span class="x">)</span> <span class="o">.+</span> <span class="x">(</span><span class="mi">1</span> <span class="o">.-</span> <span class="n">y</span><span class="x">)</span> <span class="o">.*</span> <span class="n">log</span><span class="o">.</span><span class="x">(</span><span class="mi">1</span> <span class="o">.-</span> <span class="n">A</span><span class="x">))</span>
    <span class="err">ùí•</span> <span class="o">/=</span> <span class="n">m</span>
    
    <span class="c"># Back-prop</span>
    <span class="n">dz</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">Y</span>
    <span class="nd">@assert</span><span class="x">(</span><span class="n">size</span><span class="x">(</span><span class="n">dz</span><span class="x">)</span> <span class="o">==</span> <span class="n">size</span><span class="x">(</span><span class="n">A</span><span class="x">)</span> <span class="o">&amp;&amp;</span> <span class="n">size</span><span class="x">(</span><span class="n">dz</span><span class="x">)</span> <span class="o">==</span> <span class="n">size</span><span class="x">(</span><span class="n">Y</span><span class="x">))</span>
        
    <span class="n">dw</span> <span class="o">=</span> <span class="x">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="x">)</span> <span class="o">*</span> <span class="n">X</span> <span class="o">*</span> <span class="n">dz</span><span class="err">'</span>
    <span class="n">db</span> <span class="o">=</span> <span class="x">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="x">)</span> <span class="o">*</span> <span class="n">sum</span><span class="x">(</span><span class="n">dz</span><span class="x">)</span>
    
    <span class="err">ùí•</span><span class="x">,</span> <span class="n">dw</span><span class="x">,</span> <span class="n">db</span>
<span class="k">end</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>propagate (generic function with 1 method)
</code></pre></div></div>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">w</span><span class="x">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">initialize</span><span class="x">(</span><span class="n">size</span><span class="x">(</span><span class="n">X</span><span class="x">,</span> <span class="mi">1</span><span class="x">))</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>([0.2004128179916913; 0.7269986373814084; 0.7116663451002054; 0.6867182335637176], 0)
</code></pre></div></div>

<h2 id="model">
<a class="anchor" href="#model" aria-hidden="true"><span class="octicon octicon-link"></span></a>Model</h2>
<p>Combine all functions to train the model
<br>
Learning rate: $\alpha = 0.09$, iterations(epochs): 150</p>

<p>Here is something I love about Julia. It‚Äôs that you can directly use symbols as variables üòç. Doesn‚Äôt it look awesome?</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Œ±</span> <span class="o">=</span> <span class="mf">0.009</span>

<span class="n">cost</span> <span class="o">=</span> <span class="kt">Array</span><span class="x">{</span><span class="kt">Float64</span><span class="x">,</span> <span class="mi">2</span><span class="x">}(</span><span class="nb">undef</span><span class="x">,</span> <span class="mi">150</span><span class="x">,</span> <span class="mi">1</span><span class="x">)</span>

<span class="k">for</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">:</span><span class="mi">150</span>
    
    <span class="err">ùí•</span><span class="x">,</span> <span class="n">dw</span><span class="x">,</span> <span class="n">db</span> <span class="o">=</span> <span class="n">propagate</span><span class="x">(</span><span class="n">w</span><span class="x">,</span> <span class="n">b</span><span class="x">,</span> <span class="n">X</span><span class="x">,</span> <span class="n">y</span><span class="x">)</span>
    
    <span class="n">cost</span><span class="x">[</span><span class="n">i</span><span class="x">]</span> <span class="o">=</span> <span class="err">ùí•</span>
    
    <span class="kd">global</span> <span class="n">w</span><span class="x">,</span> <span class="n">b</span>
    
    <span class="n">w</span> <span class="o">-=</span> <span class="n">Œ±</span> <span class="o">*</span> <span class="n">dw</span><span class="x">;</span>  
    <span class="n">b</span> <span class="o">-=</span> <span class="n">Œ±</span> <span class="o">*</span> <span class="n">db</span><span class="x">;</span>
        
    <span class="n">println</span><span class="x">(</span><span class="s">"cost after iteration </span><span class="si">$</span><span class="s">i: </span><span class="si">$</span><span class="s">ùí•"</span><span class="x">)</span>

<span class="k">end</span>
    
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cost after iteration 1: 2.3740023073890866
cost after iteration 2: 2.3462116695406623
cost after iteration 3: 2.318509301558028
cost after iteration 4: 2.2908975633354554
cost after iteration 5: 2.2633788921961275
cost after iteration 6: 2.235955804801441
cost after iteration 7: 2.2086308999424062
cost after iteration 8: 2.1814068611217134
cost after iteration 9: 2.154286458914731
cost after iteration 10: 2.127272553920777
cost after iteration 11: 2.1003680993236715
cost after iteration 12: 2.0735761437103326
cost after iteration 13: 2.0468998340349147
cost after iteration 14: 2.02034241843537
cost after iteration 15: 1.9939072492856498
cost after iteration 16: 1.9675977862410752
cost after iteration 17: 1.9414175993047091
cost after iteration 18: 1.9153703719657098
cost after iteration 19: 1.889459904350958
cost after iteration 20: 1.8636901163469042
cost after iteration 21: 1.8380650507400902
cost after iteration 22: 1.8125888762724895
cost after iteration 23: 1.7872658906347527
cost after iteration 24: 1.7621005233341813
cost after iteration 25: 1.7370973384132224
cost after iteration 26: 1.712261036954804
cost after iteration 27: 1.687596459348754
cost after iteration 28: 1.6631085872491747
cost after iteration 29: 1.6388025451803738
cost after iteration 30: 1.6146836017227515
cost after iteration 31: 1.590757170225785
cost after iteration 32: 1.567028808982005
cost after iteration 33: 1.5435042207992091
cost after iteration 34: 1.5201892519078846
cost after iteration 35: 1.4970898901396426
cost after iteration 36: 1.4742122623148985
cost after iteration 37: 1.4515626307794567
cost after iteration 38: 1.4291473890317374
cost after iteration 39: 1.4069730563873706
cost after iteration 40: 1.3850462716301533
cost after iteration 41: 1.3633737856049706
cost after iteration 42: 1.3419624527121798
cost after iteration 43: 1.320819221270383
cost after iteration 44: 1.299951122719665
cost after iteration 45: 1.279365259645181
cost after iteration 46: 1.2590687926069641
cost after iteration 47: 1.2390689257689431
cost after iteration 48: 1.219372891326446
cost after iteration 49: 1.1999879327368639
cost after iteration 50: 1.180921286762925
cost after iteration 51: 1.1621801643408496
cost after iteration 52: 1.1437717302868156
cost after iteration 53: 1.1257030818538676
cost after iteration 54: 1.1079812261472688
cost after iteration 55: 1.090613056399182
cost after iteration 56: 1.073605327093288
cost after iteration 57: 1.0569646279166243
cost after iteration 58: 1.040697356500272
cost after iteration 59: 1.024809689893287
cost after iteration 60: 1.00930755469731
cost after iteration 61: 0.9941965957744495
cost after iteration 62: 0.9794821434313243
cost after iteration 63: 0.9651691789807894
cost after iteration 64: 0.9512622985935968
cost after iteration 65: 0.937765675379124
cost after iteration 66: 0.9246830196811211
cost after iteration 67: 0.9120175376445453
cost after iteration 68: 0.8997718882052996
cost after iteration 69: 0.8879481387767842
cost after iteration 70: 0.8765477200543355
cost after iteration 71: 0.8655713805269151
cost after iteration 72: 0.8550191414681693
cost after iteration 73: 0.8448902533664484
cost after iteration 74: 0.8351831549332133
cost after iteration 75: 0.8258954359868429
cost after iteration 76: 0.8170238056283772
cost after iteration 77: 0.8085640671913646
cost after iteration 78: 0.8005111014454732
cost after iteration 79: 0.7928588594516951
cost after iteration 80: 0.7856003662995654
cost after iteration 81: 0.7787277367034907
cost after iteration 82: 0.7722322031028225
cost after iteration 83: 0.766104156512534
cost after iteration 84: 0.7603331999287829
cost after iteration 85: 0.7549082136319242
cost after iteration 86: 0.7498174312775551
cost after iteration 87: 0.7450485252532479
cost after iteration 88: 0.7405886994319086
cost after iteration 89: 0.7364247871943844
cost after iteration 90: 0.7325433524392283
cost after iteration 91: 0.7289307912533028
cost after iteration 92: 0.7255734319813323
cost after iteration 93: 0.722457631595763
cost after iteration 94: 0.7195698665139034
cost after iteration 95: 0.716896816316328
cost after iteration 96: 0.7144254391657412
cost after iteration 97: 0.7121430380857576
cost after iteration 98: 0.7100373176131921
cost after iteration 99: 0.7080964306677431
cost after iteration 100: 0.7063090157759134
cost after iteration 101: 0.7046642250328173
cost after iteration 102: 0.7031517433816896
cost after iteration 103: 0.701761799935867
cost after iteration 104: 0.700485172164231
cost after iteration 105: 0.6993131838133823
cost after iteration 106: 0.6982376974542951
cost after iteration 107: 0.6972511025247742
cost after iteration 108: 0.6963462996986156
cost after iteration 109: 0.6955166823545526
cost after iteration 110: 0.6947561158487165
cost after iteration 111: 0.6940589152185364
cost after iteration 112: 0.6934198218678441
cost after iteration 113: 0.6928339797057265
cost after iteration 114: 0.6922969111377242
cost after iteration 115: 0.6918044932390484
cost after iteration 116: 0.6913529343765882
cost after iteration 117: 0.690938751490183
cost after iteration 118: 0.6905587481941259
cost after iteration 119: 0.6902099938169665
cost after iteration 120: 0.6898898034611582
cost after iteration 121: 0.6895957191333673
cost after iteration 122: 0.6893254919709155
cost after iteration 123: 0.6890770655691838
cost after iteration 124: 0.6888485603983463
cost after iteration 125: 0.6886382592849551
cost after iteration 126: 0.6884445939241216
cost after iteration 127: 0.688266132380874
cost after iteration 128: 0.6881015675342764
cost after iteration 129: 0.6879497064146782
cost after iteration 130: 0.6878094603827019
cost after iteration 131: 0.6876798360979788
cost after iteration 132: 0.6875599272259485
cost after iteration 133: 0.6874489068320602
cost after iteration 134: 0.6873460204142585
cost after iteration 135: 0.6872505795265694
cost after iteration 136: 0.6871619559488045
cost after iteration 137: 0.6870795763597692
cost after iteration 138: 0.6870029174738363
cost after iteration 139: 0.6869315016032344
cost after iteration 140: 0.6868648926109056
cost after iteration 141: 0.6868026922212128
cost after iteration 142: 0.6867445366581466
cost after iteration 143: 0.6866900935829536
cost after iteration 144: 0.6866390593052681
cost after iteration 145: 0.6865911562438682
cost after iteration 146: 0.6865461306151157
cost after iteration 147: 0.6865037503289286
cost after iteration 148: 0.6864638030738268
cost after iteration 149: 0.6864260945741462
cost after iteration 150: 0.6863904470039756
</code></pre></div></div>

<h2 id="plotting">
<a class="anchor" href="#plotting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Plotting</h2>
<p>For plotting we use the <code class="highlighter-rouge">Plots</code> package.</p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span><span class="o">:</span><span class="mi">150</span><span class="x">;</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cost</span><span class="x">;</span>

<span class="n">gr</span><span class="x">()</span> <span class="c"># backend</span>

<span class="n">plot</span><span class="x">(</span><span class="n">x</span><span class="x">,</span> <span class="n">y</span><span class="x">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s">"Cost v/s iteration"</span><span class="x">,</span> <span class="n">label</span><span class="o">=</span><span class="s">"negative log-likelihood"</span><span class="x">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="x">)</span>
<span class="n">xlabel!</span><span class="x">(</span><span class="s">"iteration"</span><span class="x">)</span>
<span class="n">ylabel!</span><span class="x">(</span><span class="s">"cost"</span><span class="x">)</span>
</code></pre></div></div>

<p><img src="output_24_0.svg" alt="svg"></p>

<div class="language-julia highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="Abhiswain97/MyBlog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/machine%20learning/maths/2020/07/28/Logistic_regression.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Pleasure of finding things out!</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Abhiswain97" title="Abhiswain97"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
